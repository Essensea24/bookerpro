<script>
$(function(){ // document ready
 
  var stickyTop = $('.amenity-sidebar').offset().top; // returns number 
 
  $(window).scroll(function(){ // scroll event  
 
    var windowTop = $(window).scrollTop(); // returns number
 
    if (stickyTop < (windowTop+50)) {
      $('.amenity-sidebar').css({ position: 'fixed', top: '50px', right: '2vw'});
    }
    else {
      $('.amenity-sidebar').css({ position: 'relative', top: '-7vh', right: '2vw'});
    }
 
  });
 
});
</script>

	<section id="booker-logo">

	    <div class="top-image-container top-image">

	        <div id="links">

		            <% @detail["HotelImages"]["HotelImage"].each do |image| %>
		                <span id="testing"><a href=<%= image["url"][0...-5] + "z.jpg" %>>
		                <img class="top-image" src=<%= image["url"][0...-5] + "z.jpg"%> onerror="this.onerror=null;this.src='<%=image["url"]%>';">
		                </a></span>
		            <% end %>
	            
	        </div>

	    </div>


		<div class="hotelshow-container">
			<div class="title-container">
				<h2><%= @detail["HotelSummary"]["name"]%></h2>
				<h5><%= @detail["HotelSummary"]["address1"]%>,
				<%= @detail["HotelSummary"]["city"]%>,
				<%= @detail["HotelSummary"]["stateProvinceCode"]%>
				 <%= @detail["HotelSummary"]["countryCode"]%>
				</h5>
			</div>

			<div class="about-container">

				<h4>About This Hotel</h4>
				<%= @detail["HotelDetails"]["locationDescription"] %><br><br>
				<p>The room rates listed are for double occupancy per room unless otherwise stated and exclude tax recovery charges and service fees.</p>

			</div>

			<%= render 'choose_room' %>


			<div class="room-selection-container">

			<% @room_responses.each do |room_response|%>
			
					<% @detail["RoomTypes"]["RoomType"].each do |room_detail| %> 
		 						<% if room_response["roomTypeCode"].to_s == room_detail["@roomCode"].to_s && room_response["RoomImages"] != nil %>
									<%#= room['descriptionLong']%>
									<div class="individual-room-container">
										<%= image_tag (room_response["RoomImages"]["RoomImage"].first[1].to_s[0...-5] + "b.jpg"), :class => "room-image" %>
										<%= room_response["roomTypeDescription"] %><br>
										<% if room_response["BedTypes"] %>
											<% if room_response["BedTypes"]["BedType"].instance_of? Array %>
												<% room_response["BedTypes"]["BedType"].each do |bed| %>	
														<%= bed["description"] %><br>
												<% end %>
											<% else %>
												<%= room_response["BedTypes"]["BedType"]["description"] %>
											<% end %>
										<% end %>
											<% if room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["NightlyRatesPerRoom"]["NightlyRate"].instance_of? Array %>
												<% if room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["NightlyRatesPerRoom"]["NightlyRate"][0]["@promo"] == "true" %>
													<del><%= number_to_currency(room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["@averageBaseRate"]) %></del>
												<% end %>
											<% elsif room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["NightlyRatesPerRoom"]["NightlyRate"].instance_of? Hash %>
												<% if room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["NightlyRatesPerRoom"]["NightlyRate"]["@promo"] == "true" %>
												 <del><%= number_to_currency(room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["@averageBaseRate"]) %></del>
												<% end %>
											<% end %>

										<%= number_to_currency(room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["@averageRate"]) %>
										<%= button_tag 'BOOK NOW', :class => 'search-container btn-warning col-md-12' %>

										<br>
									</div>
								<% elsif room_response["roomTypeCode"].to_s == room_detail["@roomCode"].to_s && room_response["RoomImages"] == nil %>
									<div class="individual-room-container">
										<%= image_tag  (@detail["HotelImages"]["HotelImage"][0]["url"]), :class => "room-image"%>"hi. stock photo here."<br>
										<%= room_response["roomTypeDescription"] %><br>
										<% if room_response["BedTypes"] %>
											<% if room_response["BedTypes"]["BedType"].instance_of? Array %>
												<% room_response["BedTypes"]["BedType"].each do |bed| %>	
														<%= bed["description"] %><br>
												<% end %>
											<% else %>
												<%= room_response["BedTypes"]["BedType"]["description"] %>
											<% end %>
										<% end %>
										<% if room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["NightlyRatesPerRoom"]["NightlyRate"].instance_of? Array %>
											<% if room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["NightlyRatesPerRoom"]["NightlyRate"][0]["@promo"] == "true" %>
													<del><%= number_to_currency(room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["@averageBaseRate"]) %></del>
											<% end %>
										<% elsif room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["NightlyRatesPerRoom"]["NightlyRate"].instance_of? Hash %>
												<% if room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["NightlyRatesPerRoom"]["NightlyRate"]["@promo"] == "true" %>
												 <del><%= number_to_currency(room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["@averageBaseRate"]) %></del>
												<% end %>
										<% end %>
										<%= number_to_currency(room_response["RateInfos"]["RateInfo"]["ChargeableRateInfo"]["@averageRate"]) %>
										<%= button_tag 'BOOK NOW', :class => 'search-container btn-warning col-md-12' %>
										<br>
									</div>
								<% end %>
							
						<% end %>
					
				<% end %>
					</div>
			
				</div>


			<div class="amenity-sidebar">

				<%= render 'sidebar' %>

			</div>

	</section>

<hr><hr>

<h1 class="text-center">View All Photos</h1>

<br><br>



<section class="masonry-grid">
	<div class="grid js-masonry"
		data-masonry-options='{ "itemSelector": ".grid-item", "columnWidth": 200 }'>

		<div class="grid-item">
			<div id="links">
				<% @detail["HotelImages"]["HotelImage"].each do |image| %>
				
			        <a href=<%= image["url"][0...-5] + "z.jpg" %>>

			        <img class="grid-item" src=<%= image["url"][0...-5] + "z.jpg" %> onerror="this.onerror=null;this.src='<%=image["url"]%>';">			  
			        </a>
			    <% end %>
			</div>
		</div>
	</div>
</section>
